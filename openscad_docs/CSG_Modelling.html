<html><head><title>CSG Modelling</title><link href="./styles/style.css" rel="stylesheet"/></head><body class="mw-body" style="height:auto"><h1 class="firstHeading" id="firstHeading">CSG Modelling</h1><div id="bodyContent">
<div aria-labelledby="mw-toc-heading" class="toc" id="toc" role="navigation"><div class="toctitle" dir="ltr" lang="en"><h2 id="mw-toc-heading">Contents</h2></div>
<ul style="list-style-image:none">
<li><a href="#boolean_overview"><span class="tocnumber">1</span> boolean overview</a>
<ul style="list-style-image:none">
<li><a href="#2D_examples"><span class="tocnumber">1.1</span> 2D examples</a></li>
<li><a href="#3D_examples"><span class="tocnumber">1.2</span> 3D examples</a></li>
</ul>
</li>
<li><a href="#union"><span class="tocnumber">2</span> union</a></li>
<li><a href="#difference"><span class="tocnumber">3</span> difference</a>
<ul style="list-style-image:none">
<li><a href="#difference_with_multiple_children"><span class="tocnumber">3.1</span> difference with multiple children</a></li>
</ul>
</li>
<li><a href="#intersection"><span class="tocnumber">4</span> intersection</a></li>
<li><a href="#render"><span class="tocnumber">5</span> render</a></li>
</ul>
</div>

<h3>boolean overview</h3>
<h5>2D examples</h5>
<ul class="gallery mw-gallery-traditional" style="list-style-image:none">
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:23.5px auto;"><a class="image" href="./imgs/120px-OpenSCAD_Boolean_Union_2D.jpg"><img alt="" data-file-height="453" data-file-width="529" decoding="async" height="103" src="./imgs/120px-OpenSCAD_Boolean_Union_2D.jpg" width="120"/></a></div></div>
			<div class="gallerytext">
<p>union ( or )           <br/> circle + square
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:23.5px auto;"><a class="image" href="./imgs/120px-OpenSCAD_Boolean_Difference_2D.jpg"><img alt="" data-file-height="453" data-file-width="529" decoding="async" height="103" src="./imgs/120px-OpenSCAD_Boolean_Difference_2D.jpg" width="120"/></a></div></div>
			<div class="gallerytext">
<p>difference ( and not ) <br/> square - circle
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:23.5px auto;"><a class="image" href="./imgs/120px-OpenSCAD_Boolean_Difference_1_2D.jpg"><img alt="" data-file-height="453" data-file-width="529" decoding="async" height="103" src="./imgs/120px-OpenSCAD_Boolean_Difference_1_2D.jpg" width="120"/></a></div></div>
			<div class="gallerytext">
<p>difference ( and not ) <br/> circle - square
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:23.5px auto;"><a class="image" href="./imgs/120px-OpenSCAD_Boolean_Intersection_2D.jpg"><img alt="" data-file-height="453" data-file-width="529" decoding="async" height="103" src="./imgs/120px-OpenSCAD_Boolean_Intersection_2D.jpg" width="120"/></a></div></div>
			<div class="gallerytext">
<p>intersection ( and )   <br/> circle - (circle - square)
</p>
			</div>
		</div></li>
</ul>
<pre> union()       {square(10);circle(10);} // square or  circle
 difference()  {square(10);circle(10);} // square and not circle
 difference()  {circle(10);square(10);} // circle and not square
 intersection(){square(10);circle(10);} // square and circle
</pre>
<h5>3D examples</h5>
<ul class="gallery mw-gallery-traditional" style="list-style-image:none">
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:15px auto;"><a class="image" href="./imgs/107px-OpenScad_Boolean_Union.jpg"><img alt="" data-file-height="204" data-file-width="182" decoding="async" height="120" src="./imgs/107px-OpenScad_Boolean_Union.jpg" width="107"/></a></div></div>
			<div class="gallerytext">
<p>union ( or )           <br/> sphere + cube
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:15px auto;"><a class="image" href="./imgs/118px-Boolean_Difference_1a.jpg"><img alt="" data-file-height="203" data-file-width="200" decoding="async" height="120" src="./imgs/118px-Boolean_Difference_1a.jpg" width="118"/></a></div></div>
			<div class="gallerytext">
<p>difference ( and not ) <br/> cube - sphere
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:17.5px auto;"><a class="image" href="./imgs/120px-OpenScad_Boolean_Difference_2.jpg"><img alt="" data-file-height="162" data-file-width="169" decoding="async" height="115" src="./imgs/120px-OpenScad_Boolean_Difference_2.jpg" width="120"/></a></div></div>
			<div class="gallerytext">
<p>difference ( and not ) <br/> sphere - cube
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:16.5px auto;"><a class="image" href="./imgs/120px-OpenScad_Boolean_Intersection.jpg"><img alt="" data-file-height="162" data-file-width="166" decoding="async" height="117" src="./imgs/120px-OpenScad_Boolean_Intersection.jpg" width="120"/></a></div></div>
			<div class="gallerytext">
<p>intersection ( and )   <br/> sphere - (sphere - cube)
</p>
			</div>
		</div></li>
</ul>
<pre> union()       {cube(12, center=true); sphere(8);} // cube or  sphere
 difference()  {cube(12, center=true); sphere(8);} // cube and not sphere
 difference()  {sphere(8); cube(12, center=true);} // sphere and not cube
 intersection(){cube(12, center=true); sphere(8);} // cube and sphere
</pre>
<h3>union</h3>
<p>Creates a union of all its child nodes. This is the <b>sum</b> of all children (logical <b>or</b>).<br/>
May be used with either 2D or 3D objects, but don't mix them.
</p><p><a class="image" href="./imgs/400px-Openscad_union.jpg" title="Union"><img alt="Union" data-file-height="924" data-file-width="1232" decoding="async" height="300" src="./imgs/400px-Openscad_union.jpg" width="400"/></a>
</p>
<pre> //Usage example:
 union() {
 	cylinder (h = 4, r=1, center = true, $fn=100);
 	rotate ([90,0,0]) cylinder (h = 4, r=0.9, center = true, $fn=100);
 }
</pre>
<p>Remark: union is implicit when not used. But it is mandatory, for example, in difference to group first child nodes into one.
</p><p><b>Note:</b> It is mandatory for all unions, explicit or implicit, that external faces to be merged not be coincident.  Failure to follow this rule results in a design with undefined behavior, and can result in a render which is not manifold (with zero volume portions, or portions inside out), which typically leads to a warning and sometimes removal of a portion of the design from the rendered output.  (This can also result in <a href="FAQ.html#What_are_those_strange_flickering_artifacts_in_the_preview?" title="OpenSCAD User Manual/FAQ">flickering effects during the preview</a>.)  This requirement is not a bug, but an intrinsic property of floating point comparisons and the fundamental inability to exactly represent irrational numbers such as those resulting from most rotations.  As an example, this is an invalid OpenSCAD program, and will at least lead to a warning on most platforms:
</p>
<pre> // Invalid!
 size = 10;
 rotation = 17;
 union() {
    rotate([rotation, 0, 0])
       cube(size);
    rotate([rotation, 0, 0])
       translate([0, 0, size])
       cube([2, 3, 4]);
 }
</pre>
<p>The solution is to always use a small value called an epsilon when merging adjacent faces like this to guarantee overlap.  Note the 0.01 eps value used in TWO locations, so that the external result is equivalent to what was intended:
</p>
<pre> // Correct!
 size = 10;
 rotation = 17;
 eps = 0.01;
 union() {
    rotate([rotation, 0, 0])
       cube(size);
    rotate([rotation, 0, 0])
       translate([0, 0, size-eps])
       cube([2, 3, 4+eps]);
 }
</pre>
<h3>difference</h3>
<p>Subtracts the 2nd (and all further) child nodes from the first one (logical <b>and not</b>).<br/>
May be used with either 2D or 3D objects, but don't mix them.
</p><p><a class="image" href="./imgs/400px-Openscad_difference.jpg" title="Difference"><img alt="Difference" data-file-height="924" data-file-width="1232" decoding="async" height="300" src="./imgs/400px-Openscad_difference.jpg" width="400"/></a>
</p>
<pre>Usage example:
difference() {
	cylinder (h = 4, r=1, center = true, $fn=100);
	rotate ([90,0,0]) cylinder (h = 4, r=0.9, center = true, $fn=100);
}
</pre>
<p><b>Note:</b> It is mandatory that surfaces that are to be removed by a difference operation have an overlap, and that the negative piece being removed extends fully outside of the volume it is removing that surface from.  Failure to follow this rule can cause <a href="FAQ.html#What_are_those_strange_flickering_artifacts_in_the_preview?" title="OpenSCAD User Manual/FAQ">preview artifacts</a> and can result in non-manifold render warnings or the removal of pieces from the render output.  See the description above in union for why this is required and an example of how to do this by this using a small epsilon value.
</p>
<h5>difference with multiple children</h5>
<p>Note, in the second instance, the result of adding a union of the 1st and 2nd children.
</p><p><a class="image" href="./imgs/Bollean_Difference_3.jpg"><img alt="Bollean Difference 3.jpg" data-file-height="262" data-file-width="256" decoding="async" height="307" src="./imgs/Bollean_Difference_3.jpg" width="300"/></a>
</p>
<pre>// Usage example for difference of multiple children:
$fn=90;
difference(){
                                            cylinder(r=5,h=20,center=true);
    rotate([00,140,-45]) color("LightBlue") cylinder(r=2,h=25,center=true);
    rotate([00,40,-50])                     cylinder(r=2,h=30,center=true);
    translate([0,0,-10])rotate([00,40,-50]) cylinder(r=1.4,h=30,center=true);
}
   
// second instance with added union
translate([10,10,0]){
    difference(){
      union(){        // combine 1st and 2nd children
                                                cylinder(r=5,h=20,center=true);
        rotate([00,140,-45]) color("LightBlue") cylinder(r=2,h=25,center=true);
      }
      rotate([00,40,-50])                       cylinder(r=2,h=30,center=true);
      translate([0,0,-10])rotate([00,40,-50])   cylinder(r=1.4,h=30,center=true);
    }
}
</pre>
<h3>intersection</h3>
<p>Creates the intersection of all child nodes. This keeps the <b>overlapping</b> portion (logical <b>and</b>).
<br/>
Only the area which is common or shared by <b>all</b> children is retained.<br/>
May be used with either 2D or 3D objects, but don't mix them.
</p><p><a class="image" href="./imgs/400px-Openscad_intersection.jpg" title="Intersection"><img alt="Intersection" data-file-height="924" data-file-width="1232" decoding="async" height="300" src="./imgs/400px-Openscad_intersection.jpg" width="400"/></a>
</p>
<pre>//Usage example:
intersection() {
	cylinder (h = 4, r=1, center = true, $fn=100);
	rotate ([90,0,0]) cylinder (h = 4, r=0.9, center = true, $fn=100);
}
</pre>
<p><br/>
</p>
<h3>render</h3>
<p><b>Warning:</b> Using render, always calculates the CSG model for this tree (even in OpenCSG preview mode).
This can make previewing very slow and OpenSCAD to appear to hang/freeze.
</p>
<pre>Usage example:
render(convexity = 1) { ... }
</pre>
<table border="1">

<tbody><tr>
<td>convexity
</td>
<td>Integer. The convexity parameter specifies the maximum number of front and back sides a ray intersecting the object might penetrate. This parameter is only needed for correctly displaying the object in OpenCSG preview mode and has no effect on the polyhedron rendering.
</td></tr></tbody></table>
<p><br/>
<a class="image" href="./imgs/400px-Openscad_convexity.jpg"><img alt="Openscad convexity.jpg" data-file-height="924" data-file-width="1232" decoding="async" height="300" src="./imgs/400px-Openscad_convexity.jpg" width="400"/></a>
</p><p>This image shows a 2D shape with a convexity of 4, as the ray indicated in red crosses the 2D shape a maximum of 4 times. The convexity of a 3D shape would be determined in a similar way. Setting it to 10 should work fine for most cases.
</p>




</div><footer class="mw-body" style="font-size:13px;color:darkgray;text-align:center;margin-bottom:-1px">
	From the WikiBooks article <a href="https://en.wikibooks.org/wiki/OpenSCAD_User_Manual/CSG_Modelling#difference" style="color:black">CSG Modelling</a> 
	(provided under <a href="https://creativecommons.org/licenses/by-sa/3.0/" style="color:black">
	CC-BY-SA-3.0</a>)</footer></body></html>