<html><head><title>Importing Geometry</title><link href="./styles/style.css" rel="stylesheet"/></head><body class="mw-body" style="height:auto"><h1 class="firstHeading" id="firstHeading">Importing Geometry</h1><div id="bodyContent">
<p>Importing is achieved by the import() command. 
</p><p><span style="font-weight: bold; font-style: normal;">[<span style="color: #A00000;">Note:</span> <span style="font-weight: normal; font-style: italic;">Requires version <span style="font-weight: bold;">2015.03-2</span></span>]</span> The <i>File &gt;&gt; Open</i> command may be used to insert this command. The file type filter of the Open File dialog may show only OpenSCAD files, but file name can be replaced with a wildcard (e.g. *.stl) to browse to additional file types.
</p>
<div aria-labelledby="mw-toc-heading" class="toc" id="toc" role="navigation"><div class="toctitle" dir="ltr" lang="en"><h2 id="mw-toc-heading">Contents</h2></div>
<ul style="list-style-image:none">
<li><a href="#import"><span class="tocnumber">1</span> import</a>
<ul style="list-style-image:none">
<li><a href="#Parameters"><span class="tocnumber">1.1</span> Parameters</a>
<ul style="list-style-image:none">
<li><a href="#Convexity"><span class="tocnumber">1.1.1</span> Convexity</a></li>
<li><a href="#Notes"><span class="tocnumber">1.1.2</span> Notes</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#import_dxf"><span class="tocnumber">2</span> import_dxf</a></li>
<li><a href="#import_stl"><span class="tocnumber">3</span> import_stl</a></li>
<li><a href="#surface"><span class="tocnumber">4</span> surface</a>
<ul style="list-style-image:none">
<li><a href="#Parameters_2"><span class="tocnumber">4.1</span> Parameters</a></li>
<li><a href="#Text_file_format"><span class="tocnumber">4.2</span> Text file format</a></li>
<li><a href="#Images"><span class="tocnumber">4.3</span> Images</a></li>
<li><a href="#Examples"><span class="tocnumber">4.4</span> Examples</a></li>
</ul>
</li>
</ul>
</div>

<h2>import</h2>
<p>Imports a file for use in the current OpenSCAD model. The file extension is used to determine which type.
</p>
<dl><dt>3D formats</dt>
<dd></dd></dl>
<ul style="list-style-image:none"><li>STL (both ASCII and Binary)</li>
<li>OFF</li>
<li>AMF <span style="font-weight: bold; font-style: normal;">[<span style="color: #A00000;">Note:</span> <span style="font-weight: normal; font-style: italic;">Requires version <span style="font-weight: bold;">2019.05</span></span>]</span></li>
<li>3MF <span style="font-weight: bold; font-style: normal;">[<span style="color: #A00000;">Note:</span> <span style="font-weight: normal; font-style: italic;">Requires version <span style="font-weight: bold;">2019.05</span></span>]</span></li></ul>
<dl><dt>2D formats</dt>
<dd></dd></dl>
<ul style="list-style-image:none"><li>DXF</li>
<li><a href="SVG_Import.html" title="OpenSCAD User Manual/SVG Import">SVG</a> <span style="font-weight: bold; font-style: normal;">[<span style="color: #A00000;">Note:</span> <span style="font-weight: normal; font-style: italic;">Requires version <span style="font-weight: bold;">2019.05</span></span>]</span></li></ul>
<dl><dt>Other</dt>
<dd>CSG can be imported using include&lt;&gt; or loaded like an SCAD file, PNG can be imported using surface()</dd></dl>
<h3>Parameters</h3>
<dl><dt>&lt;file&gt;</dt>
<dd>A string containing the path to file.:If the give path is not absolute, it is resolved relative to the importing script. Note that when using <code>include&lt;&gt;</code> with a script that uses <code>import()</code>, this is relative to the script doing the <code>include&lt;&gt;</code>.</dd>
<dt>&lt;convexity&gt;</dt>
<dd>An Integer. The convexity parameter specifies the maximum number of front sides (back sides) a ray intersecting the object might penetrate. This parameter is needed only for correctly displaying the object in OpenCSG preview mode and has no effect on the polyhedron rendering. Optional.</dd>
<dt>&lt;layer&gt;</dt>
<dd>For DXF import only, specify a specific layer to import. Optional.</dd></dl>
<pre>import("example012.stl", convexity=3);
import("D:/Documents and Settings/User/My Documents/Gear.stl", convexity=3);
(Windows users must "escape" the backslashes by writing them doubled, or replace the backslashes with forward slashes.)
</pre>
<p>Read a layer of a 2D DXF file and create a 3D shape.
</p>
<pre>linear_extrude(height = 5, center = true, convexity = 10)
		import_dxf(file = "example009.dxf", layer = "plate");
</pre>
<h4>Convexity</h4>
<p><a class="image" href="./imgs/400px-Openscad_convexity.jpg"><img alt="Openscad convexity.jpg" data-file-height="924" data-file-width="1232" decoding="async" height="300" src="./imgs/400px-Openscad_convexity.jpg" width="400"/></a>
</p><p>This image shows a 2D shape with a convexity of 4, as the ray indicated in red crosses the 2D shape a maximum of 4 times. The convexity of a 3D shape would be determined in a similar way. Setting it to 10 should work fine for most cases.
</p>
<h4>Notes</h4>
<p>In the latest version of OpenSCAD, import() is now used for importing both 2D (DXF for extrusion) and 3D (STL) files.
</p><p>If you want to render the imported STL file later, you have to make sure that the STL file is "clean". This means that the mesh has to be manifold and should not contain holes nor self-intersections. If the STL is not clean, it might initially import and preview fine, but then as soon as you attempt to perform computational geometry on it by rendering a combination of it with something else, you might get warnings about it not being manifold, your imported stl might disappear from the output entirely, or you might get errors like:
</p>
<pre> CGAL error in CGAL_Build_PolySet: CGAL ERROR: assertion violation!
 Expr: check_protocoll == 0
 File: /home/don/openscad_deps/mxe/usr/i686-pc-mingw32/include/CGAL/Polyhedron_incremental_builder_3.h
 Line: 199
</pre>
<p>or
</p>
<pre> CGAL error in CGAL_Nef_polyhedron3(): CGAL ERROR: assertion violation!
 Expr: pe_prev-&gt;is_border() || !internal::Plane_constructor&lt;Plane&gt;::get_plane(pe_prev-&gt;facet(),pe_prev-&gt;facet()-&gt;plane()).is_degenerate()
 File: /home/don/openscad_deps/mxe/usr/i686-pc-mingw32/include/CGAL/Nef_3/polyhedron_3_to_nef_3.h
 Line: 253
</pre>
<p>In order to clean the STL file, you have the following options:
</p>
<ul style="list-style-image:none"><li>use <a class="external free" href="https://wiki.netfabb.com/Semi-Automatic_Repair_Options" rel="nofollow">http://wiki.netfabb.com/Semi-Automatic_Repair_Options</a> to repair the holes but not the self-intersections.</li>
<li>use netfabb basic. This free software doesn't have the option to close holes nor can it fix the self-intersections.</li>
<li>use MeshLab, This free software can fix all the issues.</li></ul>
<p>Using MeshLab, you can do:
</p>
<ul style="list-style-image:none"><li>Render - Show non Manif Edges</li>
<li>Render - Show non Manif Vertices</li>
<li>if found, use Filters - Selection - Select non Manifold Edges or Select non Manifold Vertices - Apply - Close. Then click button 'Delete the current set of selected vertices...' or check <a class="external free" href="https://www.youtube.com/watch?v=oDx0Tgy0UHo" rel="nofollow">http://www.youtube.com/watch?v=oDx0Tgy0UHo</a> for an instruction video. The screen should show "0 non manifold edges", "0 non manifold vertices"</li></ul>
<p><br/>
Next, you can click the icon 'Fill Hole', select all the holes and click Fill and then Accept. You might have to redo this action a few times.
</p><p>Use File - Export Mesh to save the STL.
</p><p><br/>
If Meshlab can't fill the last hole then Blender might help:
</p>
<ol><li>Start Blender</li>
<li>`X, 1` to remove the default object</li>
<li>File, Import, Stl</li>
<li>`Tab` to edit the mesh</li>
<li>`A` to de-select all vertices</li>
<li>`Alt+Ctrl+Shift+M` to select all non-manifold vertices</li>
<li>`MMB` to rotate, `Shift+MMB` to pan, `wheel` to zoom</li>
<li>`C` for "circle" select, `Esc` to finish</li>
<li>`Alt+M, 1` to merge or `Space` and search for "merge" as alternative</li>
<li>Merging vertices is a useful way of filling holes where the vertices are so closely packed that the slight change in geometry is unimportant compared to the precision of a typical 3D printer</li></ol>
<h2>import_dxf</h2>
<p>[<i><span style="font-weight: bold; color: #A00000;">Deprecated:</span> <b>import_dxf()</b> will be removed in future releases. Use <b>import()</b> instead.</i>]
</p><p>Read a DXF file and create a 3D shape.
</p>
<pre>linear_extrude(height = 5, center = true, convexity = 10)
		import_dxf(file = "example009.dxf", layer = "plate");
</pre>
<h2>import_stl</h2>
<p>[<i><span style="font-weight: bold; color: #A00000;">Deprecated:</span> <b>import_stl()</b> will be removed in future releases. Use <b>import()</b> instead.</i>]
</p><p>Imports an STL file for use in the current OpenSCAD model
</p>
<pre>import_stl("body.stl", convexity = 5);
</pre>
<h2>surface</h2>
<p><code>surface()</code> reads <a class="extiw" href="https://en.wikipedia.org/wiki/Heightmap" title="w:Heightmap">Heightmap</a> information from text or image files.
It can read <b>PNG</b> files.
</p>
<h3>Parameters</h3>
<dl><dt>file</dt>
<dd>String. The path to the file containing the heightmap data.</dd></dl>
<dl><dt>center</dt>
<dd>Boolean.  This determines the positioning of the generated object.  If true, object is centered in X- and Y-axis.  Otherwise, the object is placed in the positive quadrant.  Defaults to false.</dd></dl>
<dl><dt>invert</dt>
<dd>Boolean. Inverts how the color values of imported images are translated into height values. This has no effect when importing text data files. Defaults to false. <span style="font-weight: bold; font-style: normal;">[<span style="color: #A00000;">Note:</span> <span style="font-weight: normal; font-style: italic;">Requires version <span style="font-weight: bold;">2015.03</span></span>]</span></dd></dl>
<dl><dt>convexity</dt>
<dd>Integer. The convexity parameter specifies the maximum number of front sides (back sides) a ray intersecting the object might penetrate. This parameter is needed only for correct display of the object in OpenCSG preview mode and has no effect on the final rendering.</dd></dl>
<h3>Text file format</h3>
<p>The format for text based heightmaps is a matrix of numbers that represent the height for a specific point. Rows are mapped to the Y-axis, columns to the X axis.
The numbers must be separated by spaces or tabs. Empty lines and lines starting with a # character are ignored.
</p>
<h3>Images</h3>
<p><span style="font-weight: bold; font-style: normal;">[<span style="color: #A00000;">Note:</span> <span style="font-weight: normal; font-style: italic;">Requires version <span style="font-weight: bold;">2015.03</span></span>]</span>
</p><p>Currently only PNG images are supported. Alpha channel information of the image is ignored and the height for the pixel is determined by converting the color value to <a class="extiw" href="https://en.wikipedia.org/wiki/Grayscale" title="w:Grayscale">Grayscale</a> using the linear luminance for the sRGB color space (Y = 0.2126R + 0.7152G + 0.0722B). The gray scale values are scaled to be in the range 0 to 100.
</p>
<h3>Examples</h3>
<p><b>Example 1:</b>
</p>
<pre>//surface.scad
surface(file = "surface.dat", center = true, convexity = 5);
%translate([0,0,5])cube([10,10,10], center =true);
</pre>
<pre>#surface.dat
10 9 8 7 6 5 5 5 5 5 
9 8 7 6 6 4 3 2 1 0 
8 7 6 6 4 3 2 1 0 0
7 6 6 4 3 2 1 0 0 0
6 6 4 3 2 1 1 0 0 0
6 6 3 2 1 1 1 0 0 0
6 6 2 1 1 1 1 0 0 0
6 6 1 0 0 0 0 0 0 0
3 1 0 0 0 0 0 0 0 0
3 0 0 0 0 0 0 0 0 0
</pre>
<p>Result:
</p><p><a class="image" href="./imgs/Openscad_surface_example_x1.png"><img alt="Openscad surface example x1.png" data-file-height="495" data-file-width="521" decoding="async" height="495" src="./imgs/Openscad_surface_example_x1.png" width="521"/></a>
</p><p><b>Example 2</b>
</p>
<pre> // example010.dat generated using octave:
 // d = (sin(1:0.2:10)' * cos(1:0.2:10)) * 10;
 // save("example010.dat", "d");
 intersection() {
   surface(file = "example010.dat", center = true, convexity = 5);
   rotate(45, [0, 0, 1]) surface(file = "example010.dat", center = true, convexity = 5); 
 }
</pre>
<p><a class="image" href="./imgs/Openscad_surface_example_x2.png"><img alt="Openscad surface example x2.png" data-file-height="366" data-file-width="397" decoding="async" height="366" src="./imgs/Openscad_surface_example_x2.png" width="397"/></a>
</p><p><b>Example 3:</b>
</p><p><span style="font-weight: bold; font-style: normal;">[<span style="color: #A00000;">Note:</span> <span style="font-weight: normal; font-style: italic;">Requires version <span style="font-weight: bold;">2015.03</span></span>]</span>
</p>
<pre>// Example 3a
scale([1, 1, 0.1])
  surface(file = "smiley.png", center = true);
</pre>
<pre>// Example 3b
scale([1, 1, 0.1])
  surface(file = "smiley.png", center = true, invert = true);
</pre>
<div class="thumb tmulti tnone center"><div class="thumbinner" style="width:672px;max-width:672px"><div class="trow"><div class="tsingle" style="width:222px;max-width:222px"><div class="thumbimage"><a class="image" href="./imgs/220px-OpenSCAD_surface_example_input_image.png"><img alt="Input image" data-file-height="300" data-file-width="400" decoding="async" height="165" src="./imgs/220px-OpenSCAD_surface_example_input_image.png" width="220"/></a></div><div class="thumbcaption">Input image</div></div><div class="tsingle" style="width:222px;max-width:222px"><div class="thumbimage"><a class="image" href="./imgs/220px-OpenSCAD_surface_example.png"><img alt="Surface output" data-file-height="600" data-file-width="800" decoding="async" height="165" src="./imgs/220px-OpenSCAD_surface_example.png" width="220"/></a></div><div class="thumbcaption">Example 3a: surface(invert = false)</div></div><div class="tsingle" style="width:222px;max-width:222px"><div class="thumbimage"><a class="image" href="./imgs/220px-OpenSCAD_surface_example__28inverted_29.png"><img alt="Surface output inverted" data-file-height="600" data-file-width="800" decoding="async" height="165" src="./imgs/220px-OpenSCAD_surface_example__28inverted_29.png" width="220"/></a></div><div class="thumbcaption">Example 3b: surface(invert = true)</div></div></div><div class="trow" style="display:flex"><div class="thumbcaption">Example 3: Using surface() with a PNG image as heightmap input.</div></div></div></div>




</div><footer class="mw-body" style="font-size:13px;color:darkgray;text-align:center;margin-bottom:-1px">
	From the WikiBooks article <a href="https://en.wikibooks.org/wiki/OpenSCAD_User_Manual/Importing_Geometry" style="color:black">Importing Geometry</a> 
	(provided under <a href="https://creativecommons.org/licenses/by-sa/3.0/" style="color:black">
	CC-BY-SA-3.0</a>)</footer></body></html>